{% extends 'base.html' %}
{% load static %}

{% block content %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="{% static 'products/style.css' %}">

<div class="container">
    <h2>결제 정보 입력</h2>
    <form id="payment_form" method="post" action="{% url 'orders:bid_complete' %}">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" id="submit_btn" class="btn btn-primary">결제정보저장</button>
    </form>
</div>

<script>
document.getElementById("payment_form").addEventListener("submit", function(event) {
    // 입력 필드 유효성 검사
    if (!validateForm()) {
        event.preventDefault(); // 폼 제출 막기
    }
});

function validateForm() {
    var cardNumber = document.getElementById("id_card_number").value;
    var expiry = document.getElementById("id_expiry").value;

    // 카드 번호 유효성 검사
    if (!validateCardNumber(cardNumber)) {
        alert("카드 번호를 올바르게 입력하세요.");
        return false;
    }

    // 만료일 유효성 검사
    if (!validateExpiry(expiry)) {
        alert("만료일을 MM/YY 형식으로 입력하세요.");
        return false;
    }

    return true; // 모든 검사 통과
}

function validateCardNumber(cardNumber) {
    // 16자리 숫자인지 검사
    var regex = /^\d{16}$/;
    return regex.test(cardNumber);
}

function validateExpiry(expiry) {
    // MM/YY 형식인지 검사
    var regex = /^(0[1-9]|1[0-2])\/\d{2}$/;
    return regex.test(expiry);
}
</script>
{% endblock %}
